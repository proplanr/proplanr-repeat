<link rel="import" href="../polymerfire/firebase-app.html">
<link rel="import" href="../polymerfire/polymerfire.html">
<link rel="import" href="../polymerfire/firebase-query.html">

<dom-module id="save-firebase">
  <template>
    <style>
      :host {
        display: block;
      }
    </style>
    <firebase-auth
      id="firebaseAuth"
      app-name="{{appName}}"
      provider="google"
      user="{{user}}">
    </firebase-auth>

    <firebase-app
      name="proplanr-repeat"
      api-key="AIzaSyA4Aumq3MnXjuH68ZYVjCsUJpymSrbKodk",
      auth-domain="proplanr-repeat.firebaseapp.com",
      database-url="https://proplanr-repeat.firebaseio.com">
    </firebase-app>

    <!-- <firebase-document
      id="repeatData"
      app-name="{{appName}}"
      path="{{saveRepeats}}"
      data="{{repeatData}}">
    </firebase-document> -->

    <proplanr-repeat ></proplanr-repeat>

  </template>    
  <script>

    // listen for saveRepeat

    saveData: function(data) {
      // console.log('logActivity:',action,description,listId,this.user);
      // Log activity
      var db = this.$.firebaseAuth.app.database();
      // var now = new Date().toLocaleString('en-US', {timeZone: 'America/Los_Angeles'});
      var now = new Date().toLocaleString();
      // let newRepeatId = db.ref('/repeats').push(data).key;

      db.ref('/repeats').push(data).then(snapshot => {
        let repeat_key = snapshot.$key;

        // add actions for number occurrencies or end date

        db.ref('/actions').push({
          repeat_key: repeat_key,
          title: data.title,
          due_date: data.due_date
        })


        
      });



      // then create actions


    }


  </script>
</dom-module>